<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <script src="../url.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Doctor Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    /* Basic Fade-in Animation for elements */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate-fadeIn {
      animation: fadeIn 0.5s ease-out forwards;
    }
    .animate-delay-100 { animation-delay: 0.1s; }
    .animate-delay-200 { animation-delay: 0.2s; }
    .animate-delay-300 { animation-delay: 0.3s; }
    .animate-delay-400 { animation-delay: 0.4s; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <div class="flex items-center justify-between mb-10 pb-4 border-b border-gray-200 animate-fadeIn animate-delay-100">
      <div class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-9 h-9 text-blue-600 mr-3">
          <path fill-rule="evenodd" d="M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0a3 3 0 0 1-6 0ZM12.75 16.5a3 3 0 1 0 6 0a3 3 0 0 0-6 0ZM.75 9.75a3 3 0 1 1 6 0a3 3 0 0 1-6 0ZM6.75 16.5a3 3 0 1 0 6 0a3 3 0 0 0-6 0ZM12.75 3a3 3 0 1 0 6 0a3 3 0 0 0-6 0Zm-9 8.25a3 3 0 1 1 6 0a3 3 0 0 1-6 0Z" clip-rule="evenodd" />
        </svg>
        <h2 class="text-3xl font-bold">Welcome, Dr. <span id="doctorName" class="text-blue-600">Loading...</span></h2>
      </div>
      <button id="logoutBtn" class="bg-red-600 hover:bg-red-700 text-white px-5 py-2.5 rounded-lg font-semibold shadow-md hover:shadow-lg transition duration-200 ease-in-out flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-2">
          <path fill-rule="evenodd" d="M7.5 3.75A1.5 1.5 0 0 0 6 5.25v13.5a1.5 1.5 0 0 0 1.5 1.5h6a1.5 1.5 0 0 0 1.5-1.5V15a.75.75 0 0 0 1.5 0v-1.5a.75.75 0 0 0-.75-.75H10.5a.75.75 0 0 1-.75-.75V10.5a.75.75 0 0 1 .75-.75h5.25a.75.75 0 0 0 .75-.75V7.5a.75.75 0 0 0-.75-.75H6.75a.75.75 0 0 0-.75.75v3h-.75A1.5 1.5 0 0 0 3 12.75v4.5A1.5 1.5 0 0 0 4.5 18H18a1.5 1.5 0 0 0 1.5-1.5V5.25A1.5 1.5 0 0 0 18 3.75h-9a1.5 1.5 0 0 0-1.5 1.5Z" clip-rule="evenodd" />
          <path fill-rule="evenodd" d="M12.25 15.75a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06l-1.72 1.72V6.75a.75.75 0 0 0-1.5 0v7.69l-1.72-1.72a.75.75 0 0 0-1.06 1.06l3 3Z" clip-rule="evenodd" />
        </svg>
        Logout
      </button>
    </div>

    <div class="bg-white rounded-xl shadow-lg p-6 mb-10 border-l-4 border-blue-500 animate-fadeIn animate-delay-200">
      <div class="grid sm:grid-cols-2 gap-y-4 gap-x-8">
        <div class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-indigo-500 mr-3">
            <path fill-rule="evenodd" d="M11.47 2.47a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L12 4.06l-3.97 3.97a.75.75 0 0 1-1.06-1.06l4.5-4.5ZM3.75 12a.75.75 0 0 1 .75-.75h14.5a.75.75 0 0 1 0 1.5H4.5a.75.75 0 0 1-.75-.75Zm.75 5.25a.75.75 0 0 1 .75-.75h14.5a.75.75 0 0 1 0 1.5H4.5a.75.75 0 0 1-.75-.75ZM7.25 21a.75.75 0 0 1 .75-.75h8a.75.75 0 0 1 .75.75V22a.75.75 0 0 1-.75.75h-8a.75.75 0 0 1-.75-.75v-1Z" clip-rule="evenodd" />
          </svg>
          <p class="text-lg font-medium text-gray-700"><strong>Specialization:</strong> <span id="specialization" class="text-blue-600 font-semibold">Loading...</span></p>
        </div>
        <div class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-green-500 mr-3">
            <path d="M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" />
            <path fill-rule="evenodd" d="M1.5 4.5a3 3 0 0 1 3-3h15a3 3 0 0 1 3 3v8.868a2.25 2.25 0 00-.597-.16l-1.42-.355a2.5 2.5 0 01-1.17-.63l-.444-.445a2.5 2.5 0 01-.63-1.17l-.356-1.42A2.25 2.25 0 0012.868 7.5H12c-2.485 0-4.5 2.015-4.5 4.5s2.015 4.5 4.5 4.5a4.504 4.504 0 002.32-.653l2.84 2.84a.75.75 0 010 1.06L19.5 22.5l1.06-1.06a.75.75 0 011.06 0l2.25 2.25a.75.75 0 010 1.06l-2.25 2.25a.75.75 0 01-1.06 0L19.5 22.5l-1.06 1.06a.75.75 0 01-1.06 0l-2.25-2.25a.75.75 0 010-1.06l2.25-2.25a.75.75 0 011.06 0l1.42 1.42a.75.75 0 00.597.16h3.635l.128-.001c.061 0 .121-.002.18-.007.03-.002.059-.005.089-.008.016-.002.03-.006.045-.01A3.003 3.003 0 0122.5 15.868V4.5a3 3 0 01-3-3H4.5a3 3 0 01-3 3v15Z" clip-rule="evenodd" />
          </svg>
          <p class="text-lg font-medium text-gray-700"><strong>Consultation Fees:</strong> <span class="text-green-600 font-semibold">₹<span id="fees">Loading...</span></span></p>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
      <div onclick="window.location.href='approve_appointment.html'"
           class="cursor-pointer bg-white rounded-xl shadow-lg p-6 border-b-4 border-green-500 hover:shadow-xl hover:translate-y-[-4px] transition-all duration-300 ease-in-out group animate-fadeIn animate-delay-300">
        <div class="flex items-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-green-600 mr-3 group-hover:rotate-6 transition-transform duration-300">
            <path fill-rule="evenodd" d="M8.603 3.799A4.49 4.49 0 0 1 12 2.25c1.487 0 2.913.67 3.897 1.549A4.49 4.49 0 0 1 18 6.75V9.75a3 3 0 0 0 3 3v7.5a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-7.5a3 3 0 0 0 3-3V6.75c0-1.013.426-1.956 1.11-2.691ZM12 12.75a1.5 1.5 0 0 1 1.5 1.5v3.75a.75.75 0 0 0 1.5 0V14.25a3 3 0 0 0-3-3H6.75a.75.75 0 0 0 0 1.5h4.5Z" clip-rule="evenodd" />
          </svg>
          <h3 class="text-xl font-semibold text-gray-800">Approve Appointments</h3>
        </div>
        <p class="text-gray-600 mb-4">Review and approve pending patient appointments.</p>
        <p class="text-blue-600 font-medium group-hover:underline text-lg">Go to Approval Page <span class="ml-1 inline-block group-hover:translate-x-1 transition-transform duration-200">→</span></p>
      </div>

      <div onclick="window.location.href='view-appointments.html'"
           class="cursor-pointer bg-white rounded-xl shadow-lg p-6 border-b-4 border-yellow-500 hover:shadow-xl hover:translate-y-[-4px] transition-all duration-300 ease-in-out group animate-fadeIn animate-delay-400">
        <div class="flex items-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-yellow-600 mr-3 group-hover:scale-110 transition-transform duration-300">
            <path d="M12 2.25a.75.75 0 0 0-1.06 0L3.94 9.19a.75.75 0 0 0 0 1.06l6.19 6.19a.75.75 0 0 0 1.06 0l6.19-6.19a.75.75 0 0 0 0-1.06L12 2.25Z" />
            <path d="M1.25 10.75A.75.75 0 0 0 .5 11.5v8a.75.75 0 0 0 .75.75H12a.75.75 0 0 0 .75-.75v-8a.75.75 0 0 0-.75-.75H1.25Zm12.5 0A.75.75 0 0 0 13.5 11.5v8a.75.75 0 0 0 .75.75H23.5a.75.75 0 0 0 .75-.75v-8a.75.75 0 0 0-.75-.75H13.75Z" />
          </svg>
          <h3 class="text-xl font-semibold text-gray-800">View Appointments</h3>
        </div>
        <p class="text-gray-600 mb-4">Access a comprehensive list of all your scheduled appointments.</p>
        <p class="text-blue-600 font-medium group-hover:underline text-lg">See All Appointments <span class="ml-1 inline-block group-hover:translate-x-1 transition-transform duration-200">→</span></p>
      </div>

      <div onclick="window.location.href='pre.html'"
           class="cursor-pointer bg-white rounded-xl shadow-lg p-6 border-b-4 border-purple-500 hover:shadow-xl hover:translate-y-[-4px] transition-all duration-300 ease-in-out group animate-fadeIn animate-delay-500">
        <div class="flex items-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-purple-600 mr-3 group-hover:animate-pulse">
            <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 9a.75.75 0 0 0-1.5 0v2.25H9a.75.75 0 0 0 0 1.5h2.25V15a.75.75 0 0 0 1.5 0v-2.25H15a.75.75 0 0 0 0-1.5h-2.25V9Z" clip-rule="evenodd" />
          </svg>
          <h3 class="text-xl font-semibold text-gray-800">Manage Availability</h3>
        </div>
        <p class="text-gray-600 mb-4">Set and update your available time slots for appointments.</p>
        <p class="text-blue-600 font-medium group-hover:underline text-lg">Set/View Times <span class="ml-1 inline-block group-hover:translate-x-1 transition-transform duration-200">→</span></p>
      </div>
    </div>
  </div>

  <script>
    const token = localStorage.getItem("doctor_token");

    // Function to fetch doctor details
    async function fetchDoctorDetails() {
      if (!token) {
        alert("Authentication required. Please login again.");
        localStorage.removeItem("doctor_token");
        window.location.href = "doctor_login.html";
        return;
      }

      try {
        const res = await fetch(`${BASE_URL}/api/doctor/me`, {
          headers: {
            Authorization: `Bearer ${token}`
          }
        });

        if (!res.ok) {
          // If response is not 2xx, throw an error
          const errorData = await res.json();
          throw new Error(errorData.message || "Unauthorized access.");
        }

        const data = await res.json();
        document.getElementById("doctorName").textContent = data.name || 'Unknown Doctor';
        document.getElementById("specialization").textContent = data.specialization || 'N/A';
        document.getElementById("fees").textContent = parseFloat(data.fees).toFixed(2) || '0.00'; // Format fees
      } catch (error) {
        console.error("Error fetching doctor details:", error);
        alert(`Session expired or error fetching data: ${error.message}. Please login again.`);
        localStorage.removeItem("doctor_token");
        window.location.href = "doctor_login.html";
      }
    }

    // Call the function on page load
    fetchDoctorDetails();

    // Logout functionality
    document.getElementById("logoutBtn").addEventListener("click", () => {
      if (confirm("Are you sure you want to logout?")) {
        localStorage.removeItem("doctor_token");
        window.location.href = "doctor_login.html";
      }
    });
  </script>
</body>
</html>